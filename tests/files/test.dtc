/dts-v1/;

/ {
	#address-cells = <0x1>;
	#size-cells = <0x1>;
	compatible = "plxtech,nas7820", "plxtech,nas782x";
	interrupt-parent = <0x1>;
	model = "Shuttle KD20";

	chosen {
		bootargs = "console=ttyS0,115200n8 earlyprintk=serial";
	};

	aliases {
		serial0 = "/uart@44200000";
		gpio0 = "/pinctrl/gpio@44000000";
		gpio1 = "/pinctrl/gpio@44100000";
		ethernet0 = "/ethernet@40400000";
	};

	memory {
		device_type = "memory";
		reg = <0x0 0x0>;
	};

	cpus {

		cpu@0 {
			compatible = "arm,arm11mpcore";
		};

		cpu@1 {
			compatible = "arm,arm11mpcore";
		};
	};

	gic@47001000 {
		compatible = "arm,arm11mp-gic";
		interrupt-controller;
		#interrupt-cells = <0x3>;
		reg = <0x47001000 0x1000 0x47000100 0x100>;
		linux,phandle = <0x1>;
		phandle = <0x1>;
	};

	reset-controller@44E00034 {
		compatible = "plxtech,nas782x-reset";
		#reset-cells = <0x1>;
		reg = <0x44e00034 0x8>;
		linux,phandle = <0x3>;
		phandle = <0x3>;
	};

	rps@44400000 {
		compatible = "plxtech,nas782x-rps";
		interrupt-controller;
		#interrupt-cells = <0x1>;
		reg = <0x44400000 0x14>;
		interrupts = <0x0 0x5 0x304>;
	};

	oscillator {
		compatible = "fixed-clock";
		#clock-cells = <0x0>;
		clock-frequency = <0x17d7840>;
		linux,phandle = <0x2>;
		phandle = <0x2>;
	};

	sysclk {
		compatible = "fixed-factor-clock";
		#clock-cells = <0x0>;
		clock-div = <0x4>;
		clock-mult = <0x1>;
		clocks = <0x2>;
		linux,phandle = <0x9>;
		phandle = <0x9>;
	};

	plla@44e001f0 {
		compatible = "plxtech,nas782x-plla";
		#clock-cells = <0x0>;
		clocks = <0x2>;
		reg = <0x44e001f0 0x10>;
		linux,phandle = <0x4>;
		phandle = <0x4>;
	};

	pllb@44f001f0 {
		compatible = "plxtech,nas782x-pllb";
		#clock-cells = <0x0>;
		clocks = <0x2>;
		reg = <0x44f001f0 0x10>;
		resets = <0x3 0x1f>;
		linux,phandle = <0x7>;
		phandle = <0x7>;
	};

	stdclk {
		compatible = "plxtech,nas782x-stdclk";
		#clock-cells = <0x1>;
		clocks = <0x2>;
		linux,phandle = <0x6>;
		phandle = <0x6>;
	};

	twdclk {
		compatible = "fixed-factor-clock";
		#clock-cells = <0x0>;
		clock-div = <0x2>;
		clock-mult = <0x1>;
		clocks = <0x4>;
		linux,phandle = <0x8>;
		phandle = <0x8>;
	};

	gmacclk {
		compatible = "fixed-clock";
		#clock-cells = <0x0>;
		clock-frequency = <0x7735940>;
		linux,phandle = <0xc>;
		phandle = <0xc>;
	};

	pinctrl {
		#address-cells = <0x1>;
		#size-cells = <0x1>;
		compatible = "plxtech,nas782x-pinctrl", "simple-bus";
		ranges;
		plxtech,mux-mask = <0xffffffff 0xcc0ffdf9 0xfc000e60 0xf03f7e0 0xf00c0fe0 0x3ffff 0x37fff 0x3fff8 0xf00 0x3f7f3>;

		gpio@44000000 {
			compatible = "plxtech,nas782x-gpio";
			reg = <0x44000000 0x100 0x44e00000 0x200>;
			interrupts = <0x0 0x15 0x304>;
			#gpio-cells = <0x2>;
			gpio-controller;
			interrupt-controller;
			#interrupt-cells = <0x2>;
			#gpio-lines = <0x20>;
			linux,phandle = <0xe>;
			phandle = <0xe>;
		};

		gpio@44100000 {
			compatible = "plxtech,nas782x-gpio";
			reg = <0x44100000 0x100 0x44f00000 0x200>;
			interrupts = <0x0 0x16 0x304>;
			#gpio-cells = <0x2>;
			gpio-controller;
			interrupt-controller;
			#interrupt-cells = <0x2>;
			#gpio-lines = <0x12>;
			linux,phandle = <0x5>;
			phandle = <0x5>;
		};

		uart0 {

			uart0-0 {
				plxtech,pins = <0x0 0x1e 0x5 0x0 0x0 0x1f 0x5 0x0>;
				linux,phandle = <0xa>;
				phandle = <0xa>;
			};
		};

		gmac0 {

			gmac0-0 {
				plxtech,pins = <0x0 0x3 0x1 0x0 0x0 0x4 0x1 0x0>;
				linux,phandle = <0xd>;
				phandle = <0xd>;
			};
		};

		nand0 {

			nand0-0 {
				plxtech,pins = <0x0 0xc 0x1 0x0 0x0 0xd 0x1 0x0 0x0 0xe 0x1 0x0 0x0 0xf 0x1 0x0 0x0 0x10 0x1 0x0 0x0 0x11 0x1 0x0 0x0 0x12 0x1 0x0 0x0 0x13 0x1 0x0 0x0 0x14 0x1 0x0 0x0 0x15 0x1 0x0 0x0 0x16 0x1 0x0 0x0 0x17 0x1 0x0 0x0 0x18 0x1 0x0>;
				linux,phandle = <0xb>;
				phandle = <0xb>;
			};
		};
	};

	pcie-controller@47C00000 {
		compatible = "plxtech,nas782x-pcie";
		device_type = "pci";
		#address-cells = <0x3>;
		#size-cells = <0x2>;
		ranges = <0x82000000 0x0 0x48000000 0x48000000 0x0 0x2000000 0xc2000000 0x0 0x4a000000 0x4a000000 0x0 0x1e00000 0x81000000 0x0 0x4be00000 0x4be00000 0x0 0x100000 0x80000000 0x0 0x4bf00000 0x4bf00000 0x0 0x100000>;
		bus-range = <0x0 0x7f>;
		reg = <0x47c00000 0x1000 0x47d00000 0x100 0x44a00000 0x10>;
		#interrupt-cells = <0x1>;
		interrupt-map-mask = <0x0 0x0 0x0 0x0>;
		interrupt-map = <0x0 0x0 0x0 0x0 0x1 0x0 0x13 0x304>;
		gpios = <0x5 0xc 0x0>;
		clocks = <0x6 0x8 0x7>;
		clock-names = "pcie", "busclk";
		resets = <0x3 0x7 0x3 0xe>;
		reset-names = "pcie", "phy";
		plxtech,pcie-hcsl-bit = <0x2>;
		plxtech,pcie-ctrl-offset = <0x120>;
		plxtech,pcie-outbound-offset = <0x138>;
		status = "okay";
	};

	pcie-controller@47E00000 {
		compatible = "plxtech,nas782x-pcie";
		device_type = "pci";
		#address-cells = <0x3>;
		#size-cells = <0x2>;
		ranges = <0x82000000 0x0 0x4c000000 0x4c000000 0x0 0x2000000 0xc2000000 0x0 0x4e000000 0x4e000000 0x0 0x1e00000 0x81000000 0x0 0x4fe00000 0x4fe00000 0x0 0x100000 0x80000000 0x0 0x4ff00000 0x4ff00000 0x0 0x100000>;
		bus-range = <0x80 0xff>;
		reg = <0x47e00000 0x1000 0x47f00000 0x100 0x44a00000 0x10>;
		#interrupt-cells = <0x1>;
		interrupt-map-mask = <0x0 0x0 0x0 0x0>;
		interrupt-map = <0x0 0x0 0x0 0x0 0x1 0x0 0x14 0x304>;
		clocks = <0x6 0xb 0x7>;
		clock-names = "pcie", "busclk";
		resets = <0x3 0x17 0x3 0xe>;
		reset-names = "pcie", "phy";
		plxtech,pcie-hcsl-bit = <0x3>;
		plxtech,pcie-ctrl-offset = <0x124>;
		plxtech,pcie-outbound-offset = <0x174>;
		status = "disabled";
	};

	local-timer@47000600 {
		compatible = "arm,arm11mp-twd-timer";
		reg = <0x47000600 0x20>;
		interrupts = <0x1 0xd 0x304>;
		clocks = <0x8>;
	};

	watchdog@47000620 {
		compatible = "mpcore_wdt";
		reg = <0x47000620 0x20>;
		interrupts = <0x1 0xe 0x304>;
		clocks = <0x8>;
	};

	timer@44400200 {
		compatible = "plxtech,nas782x-rps-timer";
		reg = <0x44400200 0x40>;
		clocks = <0x9>;
	};

	uart@44200000 {
		compatible = "ns16550a";
		reg = <0x44200000 0x100>;
		clock-frequency = <0x5f5e10>;
		interrupts = <0x0 0x17 0x304>;
		reg-shift = <0x0>;
		fifo-size = <0x10>;
		reg-io-width = <0x1>;
		current-speed = <0x1c200>;
		no-loopback-test;
		pinctrl-names = "default";
		pinctrl-0 = <0xa>;
		status = "okay";
	};

	sata@45900000 {
		compatible = "plxtech,nas782x-sata";
		reg = <0x45900000 0x20000 0x459a0000 0x40 0x459b0000 0x20 0x459e0000 0x2000 0x44900000 0xc 0x50000000 0x1000>;
		interrupts = <0x0 0x12 0x304>;
		clocks = <0x6 0x4>;
		resets = <0x3 0xb 0x3 0xc 0x3 0xd>;
		reset-names = "sata", "link", "phy";
		nr-ports = <0x2>;
		status = "okay";
	};

	nand@41000000 {
		compatible = "plxtech,nand-nas782x", "gen_nand";
		reg = <0x41000000 0x100000 0x41c00000 0x20>;
		nand-ecc-mode = "soft";
		clocks = <0x6 0x9>;
		pinctrl-names = "default";
		pinctrl-0 = <0xb>;
		resets = <0x3 0xf>;
		#address-cells = <0x1>;
		#size-cells = <0x1>;
		status = "okay";

		partition@0 {
			label = "boot";
			reg = <0x0 0xe00000>;
		};

		partition@e00000 {
			label = "ubi";
			reg = <0xe00000 0x7200000>;
		};
	};

	ethernet@40400000 {
		compatible = "plxtech,nas782x-gmac", "snps,dwmac";
		reg = <0x40400000 0x2000>;
		interrupts = <0x0 0x8 0x304 0x0 0x11 0x304>;
		interrupt-names = "macirq", "eth_wake_irq";
		mac-address = [00 00 00 00 00 00];
		phy-mode = "rgmii-id";
		clocks = <0x6 0x7 0xc>;
		clock-names = "gmac", "stmmaceth";
		pinctrl-names = "default";
		pinctrl-0 = <0xd>;
		resets = <0x3 0x6>;
		status = "okay";
		snps,phy-addr = <0x1>;
	};

	ehci@40200100 {
		compatible = "plxtech,nas782x-ehci";
		reg = <0x40200100 0xf00>;
		interrupts = <0x0 0x7 0x304>;
		clocks = <0x6 0x6 0x7 0x6 0xc>;
		clock-names = "usb", "refsrc", "phyref";
		resets = <0x3 0x4 0x3 0x5 0x3 0x1a>;
		reset-names = "host", "phya", "phyb";
		plxtech,ehci_use_pllb;
		status = "okay";
	};

	i2c-gpio {
		compatible = "i2c-gpio";
		gpios = <0x5 0x9 0x0 0x5 0xa 0x0>;
		i2c-gpio,delay-us = <0xa>;
		#address-cells = <0x1>;
		#size-cells = <0x0>;

		rtc@51 {
			compatible = "nxp,pcf8563";
			reg = <0x51>;
		};
	};

	gpio-keys-polled {
		compatible = "gpio-keys-polled";
		#address-cells = <0x1>;
		#size-cells = <0x0>;
		poll-interval = <0x64>;

		power {
			label = "power";
			gpios = <0xe 0xa 0x1>;
			linux,code = <0x74>;
		};

		reset {
			label = "reset";
			gpios = <0xe 0xb 0x1>;
			linux,code = <0x198>;
		};

		eject1 {
			label = "eject1";
			gpios = <0xe 0x5 0x1>;
			linux,code = <0xa1>;
		};

		eject2 {
			label = "eject2";
			gpios = <0xe 0x6 0x1>;
			linux,code = <0xa2>;
		};
	};

	gpio-leds {
		compatible = "gpio-leds";

		status {
			label = "kd20:blue:status";
			gpios = <0x5 0x10 0x0>;
		};

		status2 {
			label = "kd20:red:status";
			gpios = <0x5 0x11 0x0>;
		};

		hdd1blue {
			label = "kd20:blue:hdd1";
			gpios = <0xe 0x1b 0x0>;
			linux,default-trigger = "ata1";
		};

		hdd1red {
			label = "kd20:red:hdd1";
			gpios = <0x5 0x4 0x0>;
		};

		hdd2blue {
			label = "kd20:blue:hdd2";
			gpios = <0x5 0x6 0x0>;
			linux,default-trigger = "ata2";
		};

		hdd2red {
			label = "kd20:red:hdd2";
			gpios = <0x5 0x7 0x0>;
		};

		usb {
			label = "kd20:blue:usb";
			gpios = <0x5 0x8 0x0>;
		};
	};

	beeper {
		compatible = "gpio-beeper";
		gpios = <0x5 0xb 0x0>;
	};

	gpio-fan {
		compatible = "gpio-fan";
		gpios = <0xe 0x2 0x1>;
		gpio-fan,speed-map = <0x0 0x0 0xbb8 0x1>;
	};

	gpio-poweroff {
		compatible = "gpio-poweroff";
		gpios = <0xe 0x9 0x0>;
	};
};
